// server.js
// Hotel AI Concierge - Express Server (FAKE AI, Î§Î©Î¡Î™Î£ OpenAI credits)

const express = require("express");
const cors = require("cors");
const bodyParser = require("body-parser");

const app = express();

// Middleware
app.use(cors());
app.use(bodyParser.json());

// ----------------- Hotel config ------------------
const hotelConfig = {
  name: "Acropolis View Hotel",
  city: "Î‘Î¸Î®Î½Î±",
  checkIn: "15:00",
  checkOut: "11:00",
  breakfast: "07:30 â€“ 10:30",
  wifiName: "AcropolisView_Guest",
  wifiPassword: "Welcome2025",
};

// ----------------- Helper: Fake AI logic ------------------
function fakeAiReply(message) {
  const text = (message || "").toLowerCase();

  // 1) Î‘ÏÎ½Î·Ï„Î¹ÎºÏŒÏ‚ Ï€ÎµÎ»Î¬Ï„Î·Ï‚ / Î¸Î­Î»ÎµÎ¹ Î½Î± ÏƒÏ„Î±Î¼Î±Ï„Î®ÏƒÎµÎ¹
  if (
    text.includes("Î´ÎµÎ½ Î¸ÎµÎ»Ï‰") ||
    text.includes("Î´ÎµÎ½ Î¸Î­Î»Ï‰") ||
    text.includes("Î¿Ï‡Î¹") ||
    text.includes("ÏŒÏ‡Î¹") ||
    text.includes("ÏƒÏ„Î±Î¼Î±Ï„Î±") ||
    text.includes("ÏƒÏ„Î±Î¼Î¬Ï„Î±") ||
    text.includes("Î¼Î·Î½ ÏƒÏ…Î½ÎµÏ‡Î¹ÏƒÎµÎ¹Ï‚") ||
    text.includes("Î¼Î·Î½ ÏƒÏ…Î½ÎµÏ‡Î¯ÏƒÎµÎ¹Ï‚") ||
    text.includes("Î´ÎµÎ½ Î¼Îµ ÎµÎ½Î´Î¹Î±Ï†ÎµÏÎµÎ¹") ||
    text.includes("Î´ÎµÎ½ Î¼Îµ ÎµÎ½Î´Î¹Î±Ï†Î­ÏÎµÎ¹") ||
    text.includes("Î´ÎµÎ½ ÎµÎ½Î´Î¹Î±Ï†ÎµÏÎ¿Î¼Î±Î¹") ||
    text.includes("Î´ÎµÎ½ ÎµÎ½Î´Î¹Î±Ï†Î­ÏÎ¿Î¼Î±Î¹") ||
    text.includes("Î´ÎµÎ½ Î¸ÎµÎ»Ï‰ Î½Î± ÏƒÏ…Î½ÎµÏ‡Î¹ÏƒÏ‰") ||
    text.includes("Î´ÎµÎ½ Î¸Î­Î»Ï‰ Î½Î± ÏƒÏ…Î½ÎµÏ‡Î¯ÏƒÏ‰")
  ) {
    return {
      reply:
        "Î£Î±Ï‚ ÎµÏ…Ï‡Î±ÏÎ¹ÏƒÏ„Î¿ÏÎ¼Îµ Ï€Î¿Î»Ï Î³Î¹Î± Ï„Î¿Î½ Ï‡ÏÏŒÎ½Î¿ ÏƒÎ±Ï‚! ðŸ˜Š Î‘Î½ Ï‡ÏÎµÎ¹Î±ÏƒÏ„ÎµÎ¯Ï„Îµ Î¿Ï„Î¹Î´Î®Ï€Î¿Ï„Îµ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, ÎµÎ¯Î¼Î±ÏƒÏ„Îµ Ï€Î¬Î½Ï„Î± ÏƒÏ„Î· Î´Î¹Î¬Î¸ÎµÏƒÎ® ÏƒÎ±Ï‚.",
      exit: true,
    };
  }

  // 2) Check-in / Check-out
  if (
    text.includes("check in") ||
    text.includes("check-in") ||
    text.includes("checkin") ||
    text.includes("check out") ||
    text.includes("checkout") ||
    text.includes("ÏƒÎµÎº Î¹Î½") ||
    text.includes("ÏƒÎµÎº Î±Î¿Ï…Ï„") ||
    text.includes("Ï‰ÏÎµÏ‚ check") ||
    text.includes("ÏŽÏÎµÏ‚ check")
  ) {
    return {
      reply: `Î£Ï„Î¿ ${hotelConfig.name} Ï„Î¿ check-in ÎµÎ¯Î½Î±Î¹ Î±Ï€ÏŒ Ï„Î¹Ï‚ ${hotelConfig.checkIn} ÎºÎ±Î¹ Ï„Î¿ check-out Î¼Î­Ï‡ÏÎ¹ Ï„Î¹Ï‚ ${hotelConfig.checkOut}.\n\nÎ‘Î½ Ï†Ï„Î¬ÏƒÎµÏ„Îµ Î½Ï‰ÏÎ¯Ï„ÎµÏÎ±, Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± ÎºÏÎ±Ï„Î®ÏƒÎ¿Ï…Î¼Îµ Ï„Î¹Ï‚ Î±Ï€Î¿ÏƒÎºÎµÏ…Î­Ï‚ ÏƒÎ±Ï‚ Î¼Î­Ï‡ÏÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ Î­Ï„Î¿Î¹Î¼Î¿ Ï„Î¿ Î´Ï‰Î¼Î¬Ï„Î¹Î¿. Î‘Î½ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏƒÏ„Îµ ÎµÎ¹Î´Î¹ÎºÎ® ÏÏÎ¸Î¼Î¹ÏƒÎ· ÏŽÏÎ±Ï‚, ÎµÎ½Î·Î¼ÎµÏÏŽÏƒÏ„Îµ Î¼Î±Ï‚ ÎºÎ±Î¹ Î¸Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ ÏŒ,Ï„Î¹ Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ. ðŸ™‚`,
    };
  }

  // 3) Î ÏÏ‰Î¹Î½ÏŒ & Ï‰ÏÎ¬ÏÎ¹Î¿
  if (
    text.includes("Ï€ÏÏ‰Î¹Î½") ||
    text.includes("Ï€ÏÏ‰Î¹Î½ÏŒ") ||
    text.includes("Ï€ÏÏ‰Î¹Î½Î¿") ||
    text.includes("breakfast") ||
    text.includes("Ï„Î¹ Ï‰ÏÎ± ÎµÎ¹Î½Î±Î¹ Ï„Î¿ Ï€ÏÏ‰Î¹Î½Î¿") ||
    text.includes("Ï„Î¹ ÏŽÏÎ± ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Ï€ÏÏ‰Î¹Î½ÏŒ")
  ) {
    return {
      reply: `Î¤Î¿ Ï€ÏÏ‰Î¹Î½ÏŒ ÏƒÎµÏÎ²Î¯ÏÎµÏ„Î±Î¹ ${hotelConfig.breakfast} ÏƒÏ„Î·Î½ Î±Î¯Î¸Î¿Ï…ÏƒÎ± Ï€ÏÏ‰Î¹Î½Î¿Ï.\n\nÎ ÏÎ¿ÏƒÏ†Î­ÏÎ¿Ï…Î¼Îµ Î¼Ï€Î¿Ï…Ï†Î­ Î¼Îµ Î¶ÎµÏƒÏ„Î¬ & ÎºÏÏÎ± Ï€Î¹Î¬Ï„Î±, Ï†ÏÎ­ÏƒÎºÎ± Ï†ÏÎ¿ÏÏ„Î±, ÎºÎ±Ï†Î­Î´ÎµÏ‚ ÎºÎ±Î¹ ÎµÏ€Î¹Î»Î¿Î³Î­Ï‚ Î³Î¹Î± Ï‡Î¿ÏÏ„Î¿Ï†Î¬Î³Î¿Ï…Ï‚. Î‘Î½ Î­Ï‡ÎµÏ„Îµ ÎºÎ¬Ï€Î¿Î¹Î± Î±Î»Î»ÎµÏÎ³Î¯Î±, ÎµÎ½Î·Î¼ÎµÏÏŽÏƒÏ„Îµ Î¼Î±Ï‚ Î³Î¹Î± Î½Î± Ï€ÏÎ¿ÏƒÎ±ÏÎ¼ÏŒÏƒÎ¿Ï…Î¼Îµ Ï„Î¹Ï‚ ÎµÏ€Î¹Î»Î¿Î³Î­Ï‚ ÏƒÎ±Ï‚. ðŸ½ï¸`,
    };
  }

  // 4) ÎœÎµÏ„Î±Ï†Î¿ÏÎ¬ Î±Ï€ÏŒ/Ï€ÏÎ¿Ï‚ Î±ÎµÏÎ¿Î´ÏÏŒÎ¼Î¹Î¿
  if (
    text.includes("Î¼ÎµÏ„Î±Ï†Î¿ÏÎ¬") ||
    text.includes("Î¼ÎµÏ„Î±Ï†Î¿ÏÎ±") ||
    text.includes("Î±ÎµÏÎ¿Î´ÏÏŒÎ¼") ||
    text.includes("Î±ÎµÏÎ¿Î´ÏÎ¿Î¼") ||
    text.includes("airport") ||
    text.includes("Ï„Î±Î¾Î¹") ||
    text.includes("Ï„Î±Î¾Î¯") ||
    text.includes("taxi") ||
    text.includes("transfer")
  ) {
    return {
      reply: `ÎœÏ€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± ÎºÎ±Î½Î¿Î½Î¯ÏƒÎ¿Ï…Î¼Îµ Î¼ÎµÏ„Î±Ï†Î¿ÏÎ¬ Î±Ï€ÏŒ ÎºÎ±Î¹ Ï€ÏÎ¿Ï‚ Ï„Î¿ Î±ÎµÏÎ¿Î´ÏÏŒÎ¼Î¹Î¿ Î¼Îµ Ï„Î±Î¾Î¯ Î® Î¹Î´Î¹Ï‰Ï„Î¹ÎºÏŒ ÏŒÏ‡Î·Î¼Î±.\n\nÎ£Ï…Î½Î®Î¸Ï‰Ï‚ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÏƒÏ„Î±Î¸ÎµÏÎ® Ï‡ÏÎ­Ï‰ÏƒÎ· Î±Ï€ÏŒ/Ï€ÏÎ¿Ï‚ Ï„Î¿ ÎºÎ­Î½Ï„ÏÎ¿ Ï„Î·Ï‚ Î‘Î¸Î®Î½Î±Ï‚. Î‘Î½ Î¼Î±Ï‚ Î´ÏŽÏƒÎµÏ„Îµ ÏŽÏÎ± Î¬Ï†Î¹Î¾Î·Ï‚/Î±Î½Î±Ï‡ÏŽÏÎ·ÏƒÎ·Ï‚ ÎºÎ±Î¹ Î±ÏÎ¹Î¸Î¼ÏŒ Ï€Ï„Î®ÏƒÎ·Ï‚, Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± ÎºÎ»ÎµÎ¯ÏƒÎ¿Ï…Î¼Îµ Î¿Î´Î·Î³ÏŒ ÎºÎ±Î¹ Î½Î± ÏƒÎ±Ï‚ ÏƒÏ„ÎµÎ¯Î»Î¿Ï…Î¼Îµ ÎµÎºÏ„Î¯Î¼Î·ÏƒÎ· ÎºÏŒÏƒÏ„Î¿Ï…Ï‚. ðŸš•`,
    };
  }

  // 5) Wi-Fi
  if (
    text.includes("wifi") ||
    text.includes("wi-fi") ||
    text.includes("Î³Î¿Ï…Î¹Ï†Î¹") ||
    text.includes("Î¹Î½Ï„ÎµÏÎ½ÎµÏ„") ||
    text.includes("internet")
  ) {
    return {
      reply: `Î¤Î¿ Wi-Fi Ï„Î¿Ï… Î¾ÎµÎ½Î¿Î´Î¿Ï‡ÎµÎ¯Î¿Ï… ÎµÎ¯Î½Î±Î¹ Î´Ï‰ÏÎµÎ¬Î½ ÏƒÎµ ÏŒÎ»Î¿Ï…Ï‚ Ï„Î¿Ï…Ï‚ Ï‡ÏŽÏÎ¿Ï…Ï‚.\n\nÎŒÎ½Î¿Î¼Î± Î´Î¹ÎºÏ„ÏÎ¿Ï…: ${hotelConfig.wifiName}\nÎšÏ‰Î´Î¹ÎºÏŒÏ‚: ${hotelConfig.wifiPassword}\n\nÎ‘Î½ Î±Î½Ï„Î¹Î¼ÎµÏ„Ï‰Ï€Î¯ÏƒÎµÏ„Îµ ÎºÎ¬Ï€Î¿Î¹Î¿ Ï€ÏÏŒÎ²Î»Î·Î¼Î± ÏƒÏÎ½Î´ÎµÏƒÎ·Ï‚, ÎµÎ½Î·Î¼ÎµÏÏŽÏƒÏ„Îµ Ï„Î·Î½ Ï…Ï€Î¿Î´Î¿Ï‡Î®. ðŸ“¶`,
    };
  }

  // 6) Î‘Î¾Î¹Î¿Î¸Î­Î±Ï„Î± Î‘Î¸Î®Î½Î±Ï‚
  if (
    text.includes("Ï„Î¹ Î½Î± ÎºÎ±Î½Ï‰") ||
    text.includes("Ï„Î¹ Î½Î± ÎºÎ¬Î½Ï‰") ||
    text.includes("Î±Î¾Î¹Î¿Î¸Î­Î±Ï„Î±") ||
    text.includes("sights") ||
    text.includes("acropolis") ||
    text.includes("Î±ÎºÏÎ¿Ï€Î¿Î»") ||
    text.includes("Î±ÎºÏÏŒÏ€Î¿Î»") ||
    text.includes("Ï€Î±ÏÎ¸ÎµÎ½Î¿Î½") ||
    text.includes("Ï€Î±ÏÎ¸ÎµÎ½ÏŽÎ½") ||
    text.includes("Ï„Î¹ Î½Î± ÎºÎ±Î½Ï‰ ÏƒÏ„Î·Î½ Î±Î¸Î·Î½Î±") ||
    text.includes("Ï„Î¹ Î½Î± ÎºÎ¬Î½Ï‰ ÏƒÏ„Î·Î½ Î±Î¸Î®Î½Î±")
  ) {
    return {
      reply: `Î“Î¹Î± Ï„Î·Î½ Î‘Î¸Î®Î½Î± Ï€ÏÎ¿Ï„ÎµÎ¯Î½Î¿Ï…Î¼Îµ Î¿Ï€Ï‰ÏƒÎ´Î®Ï€Î¿Ï„Îµ:\nâ€¢ Î•Ï€Î¯ÏƒÎºÎµÏˆÎ· ÏƒÏ„Î·Î½ Î‘ÎºÏÏŒÏ€Î¿Î»Î· & ÏƒÏ„Î¿ ÎœÎ¿Ï…ÏƒÎµÎ¯Î¿ Î‘ÎºÏÏŒÏ€Î¿Î»Î·Ï‚\nâ€¢ Î’ÏŒÎ»Ï„Î± ÏƒÏ„Î·Î½ Î Î»Î¬ÎºÎ± â€“ ÎœÎ¿Î½Î±ÏƒÏ„Î·ÏÎ¬ÎºÎ¹\nâ€¢ Î‘Ï€Î¿Î³ÎµÏ…Î¼Î±Ï„Î¹Î½ÏŒ Ï€ÎµÏÎ¯Ï€Î±Ï„Î¿ Î® Ï€Î¿Ï„ÏŒ ÏƒÏ„Î¿Î½ Î›Ï…ÎºÎ±Î²Î·Ï„Ï„ÏŒ Î¼Îµ Ï€Î±Î½Î¿ÏÎ±Î¼Î¹ÎºÎ® Î¸Î­Î±\n\nÎ‘Î½Î¬Î»Î¿Î³Î± Î¼Îµ Ï„Î¿Î½ Ï‡ÏÏŒÎ½Î¿ ÏƒÎ±Ï‚, Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± Ï€ÏÎ¿Ï„ÎµÎ¯Î½Î¿Ï…Î¼Îµ ÎºÎ±Î¹ Î·Î¼ÎµÏÎ®ÏƒÎ¹ÎµÏ‚ ÎµÎºÎ´ÏÎ¿Î¼Î­Ï‚ Î® Î¿ÏÎ³Î±Î½Ï‰Î¼Î­Î½ÎµÏ‚ Î¾ÎµÎ½Î±Î³Î®ÏƒÎµÎ¹Ï‚. ðŸ—ºï¸`,
    };
  }

  // 7) Î‘Î½Î±Î²Î¬Î¸Î¼Î¹ÏƒÎ· Î´Ï‰Î¼Î±Ï„Î¯Î¿Ï…
  if (
    text.includes("upgrade") ||
    text.includes("Î±Î½Î±Î²Î±Î¸Î¼") ||
    text.includes("Î±Î½Î±Î²Î¬Î¸Î¼") ||
    text.includes("Î´Ï‰Î¼Î±Ï„Î¹Î¿") ||
    text.includes("Î´Ï‰Î¼Î¬Ï„Î¹Î¿") ||
    text.includes("room")
  ) {
    return {
      reply: `Î‘Î½Î±Î²Î±Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ Î´Ï‰Î¼Î±Ï„Î¯Ï‰Î½ Î³Î¯Î½Î¿Î½Ï„Î±Î¹ Î±Î½Î¬Î»Î¿Î³Î± Î¼Îµ Ï„Î· Î´Î¹Î±Î¸ÎµÏƒÎ¹Î¼ÏŒÏ„Î·Ï„Î±.\n\nÎ£Ï…Ï‡Î½Î¬ Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± Ï€ÏÎ¿ÏƒÏ†Î­ÏÎ¿Ï…Î¼Îµ ÎºÎ±Î»ÏÏ„ÎµÏÎ· ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î± Î´Ï‰Î¼Î±Ï„Î¯Î¿Ï… Î® Î¸Î­Î± Î‘ÎºÏÏŒÏ€Î¿Î»Î·Ï‚ Î¼Îµ Î¼Î¹ÎºÏÎ® ÎµÏ€Î¹Ï€Î»Î­Î¿Î½ Ï‡ÏÎ­Ï‰ÏƒÎ·. Î‘Î½ Î¼Î±Ï‚ Ï€ÎµÎ¯Ï„Îµ Ï„Î¹Ï‚ Î·Î¼ÎµÏÎ¿Î¼Î·Î½Î¯ÎµÏ‚ Ï„Î·Ï‚ Î´Î¹Î±Î¼Î¿Î½Î®Ï‚ ÏƒÎ±Ï‚, Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± ÏƒÎ±Ï‚ Ï€ÏÎ¿Ï„ÎµÎ¯Î½Î¿Ï…Î¼Îµ ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½ÎµÏ‚ ÎµÏ€Î¹Î»Î¿Î³Î­Ï‚. ðŸ¨`,
    };
  }

  // 8) Default Î±Ï€Î¬Î½Ï„Î·ÏƒÎ·
  return {
    reply: `Î£Î±Ï‚ ÎµÏ…Ï‡Î±ÏÎ¹ÏƒÏ„Î¿ÏÎ¼Îµ Î³Î¹Î± Ï„Î¿ Î¼Î®Î½Ï…Î¼Î¬ ÏƒÎ±Ï‚! ðŸ˜Š Î•Î¯Î¼Î±Î¹ Î¿ ÏˆÎ·Ï†Î¹Î±ÎºÏŒÏ‚ concierge Ï„Î¿Ï… ${hotelConfig.name} ÏƒÏ„Î·Î½ ${hotelConfig.city}.\n\nÎœÏ€Î¿ÏÏŽ Î½Î± ÏƒÎ±Ï‚ Î²Î¿Î·Î¸Î®ÏƒÏ‰ Î¼Îµ:\nâ€¢ ÎÏÎµÏ‚ check-in / check-out\nâ€¢ Î ÏÏ‰Î¹Î½ÏŒ & Ï€Î±ÏÎ¿Ï‡Î­Ï‚\nâ€¢ Wi-Fi & Ï…Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚ Î´Ï‰Î¼Î±Ï„Î¯Î¿Ï…\nâ€¢ ÎœÎµÏ„Î±Ï†Î¿ÏÎ­Ï‚ Î±ÎµÏÎ¿Î´ÏÎ¿Î¼Î¯Î¿Ï…\nâ€¢ Î ÏÎ¿Ï„Î¬ÏƒÎµÎ¹Ï‚ Î³Î¹Î± Ï„Î·Î½ Î‘Î¸Î®Î½Î±\n\nÎ ÎµÎ¯Ï„Îµ Î¼Î¿Ï… Î¼Îµ Î»Î¯Î³Î± Î»ÏŒÎ³Î¹Î± Ï„Î¹ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏƒÏ„Îµ.`,
  };
}

// ----------------- API Routes ------------------

// Health check
app.get("/health", (req, res) => {
  res.json({ status: "ok", service: "hotel-ai-concierge" });
});

// Chat endpoint
app.post("/api/chat", (req, res) => {
  const userMsg = req.body.message || "";
  console.log("ÎÎ­Î¿ Î¼Î®Î½Ï…Î¼Î± Ï€ÎµÎ»Î¬Ï„Î·:", userMsg);

  const result = fakeAiReply(userMsg);
  res.json({
    reply: result.reply,
    exit: Boolean(result.exit),
  });
});

// ----------------- Start server ------------------
const PORT = process.env.PORT || 3000;

app.listen(PORT, () => {
  console.log(`FAKE AI Concierge server running at http://localhost:${PORT}`);
});
