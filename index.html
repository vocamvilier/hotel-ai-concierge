<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8" />
  <title>AI Concierge â€“ Hotel Widget</title>

  <style>
    :root {
      --primary: #2563eb;
      --primary-dark: #1d4ed8;
      --bg-dark: #020617;
      --bg-light: #f3f4f6;
    }

    body {
      font-family: "Segoe UI", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: radial-gradient(circle at top, #1d4ed8 0, #020617 55%);
      margin: 0;
      min-height: 100vh;
      color: white;
    }

    body.light-theme {
      background: linear-gradient(180deg, #e5e7eb, #ffffff);
      color: #020617;
    }

    /* ÎœÎ¹ÎºÏÎ® ÎºÎ¬ÏÏ„Î± Î¾ÎµÎ½Î¿Î´Î¿Ï‡ÎµÎ¯Î¿Ï… ÎµÏ€Î¬Î½Ï‰ Î±ÏÎ¹ÏƒÏ„ÎµÏÎ¬ */
    #hotelCard {
      position: fixed;
      top: 20px;
      left: 20px;
      padding: 14px 18px;
      border-radius: 18px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.5);
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      max-width: 260px;
      font-size: 13px;
    }

    body.light-theme #hotelCard {
      background: #ffffff;
      color: #020617;
      border-color: #cbd5f5;
    }

    #hotelCard h1 {
      margin: 0 0 4px;
      font-size: 17px;
    }

    #hotelCard small {
      color: #e5e7eb;
      opacity: 0.8;
    }

    body.light-theme #hotelCard small {
      color: #4b5563;
    }

    /* Floating chat bubble */
    #chatBubble {
      width: 64px;
      height: 64px;
      background: radial-gradient(circle at 30% 0, #ffffff80 0, #ffffff00 40%),
                  linear-gradient(135deg, var(--primary), var(--primary-dark));
      border-radius: 50%;
      position: fixed;
      bottom: 20px;
      right: 20px;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.55);
      color: white;
      font-size: 30px;
      border: 1px solid rgba(191, 219, 254, 0.6);
      transition: transform 0.18s ease, box-shadow 0.18s ease;
      z-index: 20;
    }

    #chatBubble:hover {
      transform: translateY(-2px) scale(1.03);
      box-shadow: 0 22px 50px rgba(0, 0, 0, 0.7);
    }

    /* Chat Window */
    #chatbox {
      width: 390px;
      height: 560px;
      border-radius: 22px;
      background: rgba(15, 23, 42, 0.96);
      border: 1px solid rgba(148, 163, 184, 0.5);
      position: fixed;
      bottom: 95px;
      right: 20px;
      display: none;
      flex-direction: column;
      overflow: hidden;
      box-shadow: 0 22px 60px rgba(0, 0, 0, 0.75);
      backdrop-filter: blur(18px);
      -webkit-backdrop-filter: blur(18px);
      animation: fadeIn 0.25s ease-out;
      z-index: 25;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(12px) scale(0.96);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    /* Header */
    #chatHeader {
      padding: 8px 10px;
      border-bottom: 1px solid rgba(148, 163, 184, 0.35);
      display: flex;
      align-items: center;
      gap: 8px;
      color: #e5e7eb;
    }

    #avatar {
      width: 34px;
      height: 34px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 0, #ffffffaa 0, #ffffff00 42%),
                  linear-gradient(135deg, #22c55e, #16a34a);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 19px;
      border: 1px solid #bbf7d0aa;
    }

    #headerText {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    #headerText strong {
      font-size: 14px;
    }

    #headerText span {
      font-size: 11px;
      color: #9ca3af;
    }

    #statusDot {
      display: inline-block;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #22c55e;
      box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.3);
      margin-right: 4px;
    }

    .headerBtn {
      cursor: pointer;
      font-size: 15px;
      color: #9ca3af;
      padding: 4px 7px;
      border-radius: 999px;
      transition: 0.15s;
      border: none;
      background: transparent;
    }

    .headerBtn:hover {
      background: rgba(148, 163, 184, 0.25);
      color: #e5e7eb;
    }

    body.light-theme #chatbox {
      background: #ffffff;
      border-color: #cbd5f5;
    }

    body.light-theme #chatHeader {
      border-bottom-color: #e5e7eb;
      color: #111827;
    }

    /* Messages */
    #messages {
      flex: 1;
      padding: 12px;
      overflow-y: auto;
      background: linear-gradient(180deg, rgba(15, 23, 42, 0.9), rgba(15, 23, 42, 1));
      font-size: 14px;
    }

    #messages p {
      padding: 8px 12px;
      border-radius: 14px;
      max-width: 80%;
      margin-bottom: 10px;
      line-height: 1.38;
      animation: fadeInMsg 0.18s ease-out;
      word-wrap: break-word;
      white-space: pre-wrap;
    }

    @keyframes fadeInMsg {
      from { opacity: 0; transform: translateY(4px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .bot {
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.7);
      color: #e5e7eb;
    }

    .user {
      background: linear-gradient(135deg, #60a5fa, #2563eb);
      color: white;
      margin-left: auto;
      border-bottom-right-radius: 4px;
    }

    body.light-theme #messages {
      background: #f3f4f6;
    }

    body.light-theme .bot {
      background: #ffffff;
      color: #111827;
      border-color: #e5e7eb;
    }

    body.light-theme .user {
      background: linear-gradient(135deg, #2563eb, #1d4ed8);
    }

    /* Typing indicator */
    #typing {
      font-size: 11px;
      color: #9ca3af;
      padding: 0 14px 6px;
      display: none;
      align-items: center;
      gap: 4px;
    }

    .typing-dot {
      width: 4px;
      height: 4px;
      border-radius: 50%;
      background: #9ca3af;
      animation: bounce 1s infinite alternate;
    }

    .typing-dot:nth-child(1) { animation-delay: 0s; }
    .typing-dot:nth-child(2) { animation-delay: 0.15s; }
    .typing-dot:nth-child(3) { animation-delay: 0.3s; }

    @keyframes bounce {
      from { transform: translateY(0); opacity: 0.5; }
      to { transform: translateY(-3px); opacity: 1; }
    }

    /* Quick actions */
    #quickActions {
      display: flex;
      gap: 6px;
      padding: 8px;
      border-top: 1px solid rgba(148, 163, 184, 0.4);
      border-bottom: 1px solid rgba(148, 163, 184, 0.3);
      background: rgba(15, 23, 42, 0.96);
      overflow-x: auto;
    }

    .quickBtn {
      padding: 6px 10px;
      background: rgba(15, 23, 42, 0.9);
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.9);
      cursor: pointer;
      font-size: 12px;
      white-space: nowrap;
      color: #e5e7eb;
      transition: 0.18s;
    }

    .quickBtn:hover {
      background: #2563eb;
      border-color: #60a5fa;
      color: white;
    }

    body.light-theme #quickActions {
      background: #ffffff;
      border-top-color: #e5e7eb;
      border-bottom-color: #e5e7eb;
    }

    body.light-theme .quickBtn {
      background: #f9fafb;
      border-color: #d1d5db;
      color: #111827;
    }

    /* Input row */
    #inputRow {
      display: flex;
      border-top: 1px solid rgba(148, 163, 184, 0.35);
      background: rgba(15, 23, 42, 0.97);
      align-items: center;
    }

    #msgInput {
      flex: 1;
      padding: 9px 10px;
      font-size: 14px;
      border: none;
      outline: none;
      background: transparent;
      color: #e5e7eb;
    }

    #msgInput::placeholder {
      color: #6b7280;
    }

    #sendBtn {
      padding: 0 16px;
      background: linear-gradient(135deg, #3b82f6, #1d4ed8);
      color: white;
      border: none;
      cursor: pointer;
      font-size: 14px;
      border-radius: 999px;
      margin: 6px;
    }

    #sendBtn:hover {
      filter: brightness(1.05);
    }

    body.light-theme #inputRow {
      background: #ffffff;
      border-top-color: #e5e7eb;
    }

    body.light-theme #msgInput {
      color: #111827;
    }

    /* Restart button */
    #restartBtn {
      display: none;
      margin: 6px 12px 10px;
      width: calc(100% - 24px);
      padding: 7px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.8);
      background: transparent;
      color: #e5e7eb;
      font-size: 13px;
      cursor: pointer;
      transition: 0.18s;
    }

    #restartBtn:hover {
      background: #2563eb;
      border-color: #60a5fa;
      color: white;
    }

    body.light-theme #restartBtn {
      color: #111827;
      border-color: #cbd5f5;
    }

    body.light-theme #restartBtn:hover {
      background: #2563eb;
      color: white;
      border-color: #60a5fa;
    }
  </style>
</head>

<body>

  <div id="hotelCard">
    <h1>Acropolis View Hotel</h1>
    <small>AI Concierge demo widget<br>Î‘Î¸Î®Î½Î±, ÎºÎ­Î½Ï„ÏÎ¿ â€“ Î´Î¯Ï€Î»Î± ÏƒÏ„Î·Î½ Î‘ÎºÏÏŒÏ€Î¿Î»Î·</small>
  </div>

  <!-- Floating chat bubble -->
  <div id="chatBubble">ğŸ’¬</div>

  <!-- Chat window -->
  <div id="chatbox">
    <div id="chatHeader">
      <div id="avatar">ğŸ¤µ</div>
      <div id="headerText">
        <strong>AI Concierge</strong>
        <span><span id="statusDot"></span>Î”Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿Ï‚ Î³Î¹Î± Î²Î¿Î®Î¸ÎµÎ¹Î± 24/7</span>
      </div>
      <button id="themeToggle" class="headerBtn">â˜¾</button>
      <button id="closeBtn" class="headerBtn">Ã—</button>
    </div>

    <div id="messages"></div>

    <div id="typing">
      <span class="typing-dot"></span>
      <span class="typing-dot"></span>
      <span class="typing-dot"></span>
      ÎŸ concierge Ï€Î»Î·ÎºÏ„ÏÎ¿Î»Î¿Î³ÎµÎ¯â€¦
    </div>

    <div id="quickActions">
      <div class="quickBtn" data-msg="Î Î¿Î¹ÎµÏ‚ ÎµÎ¯Î½Î±Î¹ Î¿Î¹ ÏÏÎµÏ‚ check-in ÎºÎ±Î¹ check-out; ğŸ•’">
        ğŸ•’ Check-in / Check-out
      </div>
      <div class="quickBtn" data-msg="Î˜Î± Î®Î¸ÎµÎ»Î± Î¼ÎµÏ„Î±Ï†Î¿ÏÎ¬ Î¼Îµ Ï„Î±Î¾Î¯ Î±Ï€ÏŒ Î® Ï€ÏÎ¿Ï‚ Ï„Î¿ Î±ÎµÏÎ¿Î´ÏÏŒÎ¼Î¹Î¿.">
        ğŸš• Î¤Î±Î¾Î¯ Î±ÎµÏÎ¿Î´ÏÎ¿Î¼Î¯Î¿Ï…
      </div>
      <div class="quickBtn" data-msg="Î¤Î¹ ÎµÏ€Î¹Î»Î¿Î³Î­Ï‚ Ï€ÏÏ‰Î¹Î½Î¿Ï Î­Ï‡ÎµÏ„Îµ ÎºÎ±Î¹ Ï€Î¿Î¹Î¿ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Ï‰ÏÎ¬ÏÎ¹Î¿;">
        ğŸ½ï¸ Î ÏÏ‰Î¹Î½ÏŒ & Ï‰ÏÎ¬ÏÎ¹Î¿
      </div>
      <div class="quickBtn" data-msg="Î Î¿Î¹ÎµÏ‚ ÎµÎ¯Î½Î±Î¹ Î¿Î¹ ÎºÎ±Î»ÏÏ„ÎµÏÎµÏ‚ ÎµÏ€Î¹Î»Î¿Î³Î­Ï‚ Î³Î¹Î± Î²ÏŒÎ»Ï„ÎµÏ‚ ÎºÎ±Î¹ Î±Î¾Î¹Î¿Î¸Î­Î±Ï„Î± ÏƒÏ„Î·Î½ Î‘Î¸Î®Î½Î±;">
        ğŸ—ºï¸ Î‘Î¾Î¹Î¿Î¸Î­Î±Ï„Î± Î‘Î¸Î®Î½Î±Ï‚
      </div>
      <div class="quickBtn" data-msg="Î¥Ï€Î¬ÏÏ‡ÎµÎ¹ Î´Ï…Î½Î±Ï„ÏŒÏ„Î·Ï„Î± Î±Î½Î±Î²Î¬Î¸Î¼Î¹ÏƒÎ·Ï‚ Ï„Î¿Ï… Î´Ï‰Î¼Î±Ï„Î¯Î¿Ï… Î¼Î¿Ï…;">
        ğŸ¨ Upgrade Î´Ï‰Î¼Î±Ï„Î¯Î¿Ï…
      </div>
      <div class="quickBtn" data-msg="Î Î¿Î¹ÏŒÏ‚ ÎµÎ¯Î½Î±Î¹ Î¿ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚ Ï„Î¿Ï… Wi-Fi;">
        ğŸ“¶ Wi-Fi
      </div>
    </div>

    <div id="inputRow">
      <input id="msgInput" placeholder="Î“ÏÎ¬ÏˆÏ„Îµ Ï„Î¿ Î±Î¯Ï„Î·Î¼Î¬ ÏƒÎ±Ï‚ ÎµÎ´Ï..." />
      <button id="sendBtn">Send</button>
    </div>

    <button id="restartBtn">ÎÎµÎºÎ¹Î½Î®ÏƒÏ„Îµ Î½Î­Î± ÏƒÏ…Î½Î¿Î¼Î¹Î»Î¯Î±</button>
  </div>

  <script>
    const chatBubble = document.getElementById("chatBubble");
    const chatbox = document.getElementById("chatbox");
    const closeBtn = document.getElementById("closeBtn");
    const themeToggle = document.getElementById("themeToggle");
    const messagesDiv = document.getElementById("messages");
    const input = document.getElementById("msgInput");
    const sendBtn = document.getElementById("sendBtn");
    const quickButtons = document.querySelectorAll(".quickBtn");
    const typingEl = document.getElementById("typing");
    const restartBtn = document.getElementById("restartBtn");

    let customerName = null;
    let isLightTheme = false;

    function toggleChat(force = null) {
      if (force === true) {
        chatbox.style.display = "flex";
        return;
      }
      if (force === false) {
        chatbox.style.display = "none";
        return;
      }
      chatbox.style.display = chatbox.style.display === "flex" ? "none" : "flex";
    }

    chatBubble.addEventListener("click", () => toggleChat());
    closeBtn.addEventListener("click", () => toggleChat(false));

    themeToggle.addEventListener("click", () => {
      isLightTheme = !isLightTheme;
      document.body.classList.toggle("light-theme", isLightTheme);
      themeToggle.textContent = isLightTheme ? "â˜€" : "â˜¾";
    });

    function getGreeting() {
      const hour = new Date().getHours();
      if (hour < 12) return "ÎšÎ±Î»Î·Î¼Î­ÏÎ±";
      if (hour < 18) return "ÎšÎ±Î»ÏŒ Î±Ï€ÏŒÎ³ÎµÏ…Î¼Î±";
      return "ÎšÎ±Î»ÏŒ Î²ÏÎ¬Î´Ï…";
    }

    // Î‘Î½Î±Î³Î½ÏÏÎ¹ÏƒÎ· Î¿Î½ÏŒÎ¼Î±Ï„Î¿Ï‚ (Î±Ï€Î»ÏŒ)
    function detectNameFromText(text) {
      const lower = text.toLowerCase();

      let m = lower.match(/Î¼Îµ Î»[ÎµÎ­]Î½Îµ\s+([^\s,.!]+)/i);
      if (m && m[1]) {
        customerName = m[1][0].toUpperCase() + m[1].slice(1);
        return;
      }

      m = lower.match(/ÎµÎ¯Î¼Î±Î¹\s+(Î¿|Î·)\s+([^\s,.!]+)/i);
      if (m && m[2]) {
        customerName = m[2][0].toUpperCase() + m[2].slice(1);
        return;
      }

      m = lower.match(/Î»Î­Î³Î¿Î¼Î±Î¹\s+([^\s,.!]+)/i);
      if (m && m[1]) {
        customerName = m[1][0].toUpperCase() + m[1].slice(1);
      }
    }

    function addMessage(text, sender) {
      const p = document.createElement("p");
      let finalText = text;

      if (sender === "bot" && customerName && !text.startsWith("Î£Î±Ï‚ ÎµÏ…Ï‡Î±ÏÎ¹ÏƒÏ„Î¿ÏÎ¼Îµ Ï€Î¿Î»Ï")) {
        finalText = `Î‘Î³Î±Ï€Î·Ï„Î­/Î® ${customerName}, ${text}`;
      }

      p.textContent = finalText;
      p.classList.add(sender);
      messagesDiv.appendChild(p);
      messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }

    function setTyping(on) {
      typingEl.style.display = on ? "flex" : "none";
    }

    function playMessageSound() {
      const AudioCtx = window.AudioContext || window.webkitAudioContext;
      if (!AudioCtx) return;
      const ctx = new AudioCtx();
      const osc = ctx.createOscillator();
      const gain = ctx.createGain();
      osc.type = "sine";
      osc.frequency.value = 880;
      osc.connect(gain);
      gain.connect(ctx.destination);
      osc.start();
      gain.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + 0.15);
      osc.stop(ctx.currentTime + 0.15);
    }

    async function sendMessage(textOverride = null) {
      const text = textOverride || input.value.trim();
      if (!text) return;

      detectNameFromText(text);
      addMessage(text, "user");
      input.value = "";

      setTyping(true);

      try {
        const res = await fetch("https://hotel-ai-concierge-production.up.railway.app/api/chat", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message: text }),
        });

        const data = await res.json();
        addMessage(data.reply, "bot");
        playMessageSound();

        if (data.exit) {
          restartBtn.style.display = "block";
          setTimeout(() => {
            toggleChat(false);
          }, 2500);
        }
      } catch (err) {
        console.error(err);
        addMessage(
          "Î¥Ï€Î¬ÏÏ‡ÎµÎ¹ Ï€ÏÎ¿ÏƒÏ‰ÏÎ¹Î½ÏŒ Ï„ÎµÏ‡Î½Î¹ÎºÏŒ Ï€ÏÏŒÎ²Î»Î·Î¼Î± Î¼Îµ Ï„Î¿Î½ server. Î”Î¿ÎºÎ¹Î¼Î¬ÏƒÏ„Îµ Î¾Î±Î½Î¬ ÏƒÎµ Î»Î¯Î³Î¿.",
          "bot"
        );
      } finally {
        setTyping(false);
      }
    }

    sendBtn.addEventListener("click", () => sendMessage());
    input.addEventListener("keydown", (e) => {
      if (e.key === "Enter") sendMessage();
    });

    quickButtons.forEach((btn) => {
      btn.addEventListener("click", () => {
        const msg = btn.dataset.msg || btn.textContent;
        sendMessage(msg);
      });
    });

    restartBtn.addEventListener("click", () => {
      messagesDiv.innerHTML = "";
      customerName = null;
      restartBtn.style.display = "none";
      addWelcomeMessages();
      toggleChat(true);
    });

    function addWelcomeMessages() {
      const greeting = getGreeting();
      addMessage(
        `${greeting}! ÎšÎ±Î»ÏÏ‚ Î®ÏÎ¸Î±Ï„Îµ ÏƒÏ„Î¿ Acropolis View Hotel. Î•Î¯Î¼Î±Î¹ Î¿ ÏˆÎ·Ï†Î¹Î±ÎºÏŒÏ‚ concierge ÏƒÎ±Ï‚ ÎºÎ±Î¹ Ï‡Î±Î¯ÏÎ¿Î¼Î±Î¹ Ï€Î¿Ï… ÎµÎ¯ÏƒÏ„Îµ Î¼Î±Î¶Î¯ Î¼Î±Ï‚.`,
        "bot"
      );
      addMessage(
        "ÎœÏ€Î¿ÏÏ Î½Î± ÏƒÎ±Ï‚ Î²Î¿Î·Î¸Î®ÏƒÏ‰ Î¼Îµ ÏÏÎµÏ‚ check-in / check-out, Ï€ÏÏ‰Î¹Î½ÏŒ, Wi-Fi, Î¼ÎµÏ„Î±Ï†Î¿ÏÎ¬ Î±Ï€ÏŒ/Ï€ÏÎ¿Ï‚ Î±ÎµÏÎ¿Î´ÏÏŒÎ¼Î¹Î¿ Î® Ï€ÏÎ¿Ï„Î¬ÏƒÎµÎ¹Ï‚ Î³Î¹Î± Î²ÏŒÎ»Ï„ÎµÏ‚ ÏƒÏ„Î·Î½ Î‘Î¸Î®Î½Î±. Î”Î¹Î±Î»Î­Î¾Ï„Îµ Î¼Î¯Î± Î±Ï€ÏŒ Ï„Î¹Ï‚ ÎµÏ€Î¹Î»Î¿Î³Î­Ï‚ Î® Î³ÏÎ¬ÏˆÏ„Îµ Ï„Î·Î½ ÎµÏÏÏ„Î·ÏƒÎ® ÏƒÎ±Ï‚ ÎµÎ»ÎµÏÎ¸ÎµÏÎ±.",
        "bot"
      );
    }

    // Î‘ÏÏ‡Î¹ÎºÏŒ welcome + Î¬Î½Î¿Î¹Î³Î¼Î± chat
    addWelcomeMessages();
    toggleChat(true);
  </script>
</body>
</html>
